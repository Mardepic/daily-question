<!DOCTYPE html>
<html lang="fi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kysymys sinulle</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@1,400&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Georgia,serif;background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);min-height:100vh;padding:20px;color:#2c3e50}
#loginContainer{max-width:400px;margin:100px auto;background:#fff;padding:40px;border-radius:20px;box-shadow:0 10px 40px rgba(0,0,0,.1)}
#loginContainer h2{text-align:center;margin-bottom:30px;color:#34495e;font-size:28px}
#loginContainer input{width:100%;padding:12px;margin-bottom:15px;border:2px solid #e0e0e0;border-radius:10px;font-size:16px;transition:border-color .3s}
#loginContainer input:focus{outline:0;border-color:#3498db}
#diaryContainer{max-width:1200px;margin:0 auto}
.diary-header{text-align:center;margin-bottom:40px;background:#fff;padding:30px;border-radius:20px;box-shadow:0 5px 20px rgba(0,0,0,.08)}
.diary-header h1{font-size:36px;color:#2c3e50;margin-bottom:10px;font-weight:400;letter-spacing:1px}
#weekNumber{font-size:20px;color:#7f8c8d;font-weight:300}
#weekContainer{display:grid;grid-template-columns:1fr;gap:20px;margin-bottom:30px}
.day-card{background:#fff;padding:30px;border-radius:15px;box-shadow:0 5px 15px rgba(0,0,0,.08);transition:transform .2s,box-shadow .2s;border-left:5px solid #3498db}
.day-card:hover{transform:translateY(-3px);box-shadow:0 8px 25px rgba(0,0,0,.12)}
.day-card:nth-child(1){border-left-color:#e74c3c}
.day-card:nth-child(2){border-left-color:#f39c12}
.day-card:nth-child(3){border-left-color:#f1c40f}
.day-card:nth-child(4){border-left-color:#2ecc71}
.day-card:nth-child(5){border-left-color:#3498db}
.day-card:nth-child(6){border-left-color:#9b59b6}
.day-card:nth-child(7){border-left-color:#e91e63}
.day-title{font-size:28px;font-weight:600;color:#2c3e50;margin-bottom:20px;padding-bottom:15px;border-bottom:2px solid #ecf0f1}
.question{font-family:Nunito,sans-serif;font-size:18px;color:#34495e;margin-bottom:20px;font-style:italic;line-height:1.6;padding:15px;background:#f8f9fa;border-radius:10px;border-left:3px solid #3498db}
textarea{width:100%;padding:15px;border:2px solid #e0e0e0;border-radius:10px;font-family:Georgia,serif;font-size:16px;line-height:1.8;resize:vertical;min-height:120px;transition:border-color .3s}
textarea:focus{outline:0;border-color:#3498db;background:#fafbfc}
.navigation{display:flex;justify-content:center;gap:15px;margin-bottom:20px}
button{padding:12px 25px;border:0;border-radius:10px;font-size:16px;cursor:pointer;transition:all .3s;font-family:Arial,sans-serif;font-weight:500}
button:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(0,0,0,.2)}
#loginContainer button{width:100%;background:#3498db;color:#fff;margin-top:10px}
#loginContainer button:hover{background:#2980b9}
.nav-button{background:#3498db;color:#fff}
.nav-button:hover{background:#2980b9}
.nav-button:disabled{background:#95a5a6;cursor:not-allowed;transform:none}
.logout-button{background:#e74c3c;color:#fff}
.logout-button:hover{background:#c0392b}
@media (max-width:768px){
.diary-header h1{font-size:28px}
.day-card{padding:20px}
.day-title{font-size:22px}
.navigation{flex-direction:column}
button{width:100%}
}
</style>
</head>
<body>

<div id="loginContainer">
    <h2>‚ú® Kysymys sinulle</h2>
    <input type="email" id="email" placeholder="S√§hk√∂posti">
    <input type="password" id="password" placeholder="Salasana">
    <button id="registerBtn">Rekister√∂idy</button>
    <button id="loginBtn">Kirjaudu sis√§√§n</button>
</div>

<div id="diaryContainer" style="display:none;">
    <div class="diary-header">
        <h1>üìñ Kysymys sinulle</h1>
        <div id="weekNumber"></div>
    </div>
    
    <div id="weekContainer"></div>
    
    <div class="navigation">
        <button class="nav-button" onclick="prevWeek()">‚Üê Edellinen viikko</button>
        <button class="nav-button" onclick="nextWeek()">Seuraava viikko ‚Üí</button>
    </div>
    
    <div class="navigation">
        <button class="logout-button" onclick="logout()">Kirjaudu ulos</button>
    </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

// --- Firebase Config ---
const firebaseConfig = {
    apiKey: "AIzaSyCJR7kIaO5R6b-mDigcaBUZbIv4lZhPd3g",
    authDomain: "reflection-diary-2026-d9b75.firebaseapp.com",
    projectId: "reflection-diary-2026-d9b75",
    storageBucket: "reflection-diary-2026-d9b75.firebasestorage.app",
    messagingSenderId: "40162654025",
    appId: "1:40162654025:web:49d152a55fced628f78c98",
    measurementId: "G-3RFHJPQV5Q"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth();
const db = getFirestore();

const year = 2026;
let currentWeek = 1;
const days = ["Maanantai", "Tiistai", "Keskiviikko", "Torstai", "Perjantai", "Lauantai", "Sunnuntai"];

// Funktio joka palauttaa kysymyksen p√§iv√§n numeron perusteella (1-365)
function getQuestion(dayOfYear) {
    const questions = {
        1:"Mik√§ saa sinut tuntemaan itsesi el√§v√§ksi?",2:"Millainen haluaisit olla kymmenen vuoden p√§√§st√§?",3:"Mik√§ on paras neuvo, jonka olet koskaan saanut?",4:"Mist√§ asiasta olet viimeksi muuttanut mielipidett√§si?",5:"Mik√§ lapsuusmuistosi on kirkkain?",6:"Millaista rakkautta haluat el√§m√§√§si?",7:"Mik√§ pelko est√§√§ sinua t√§ll√§ hetkell√§?",8:"Kenelle olet kiitollinen ja miksi?",9:"Mik√§ on suurin saavutuksesi t√§h√§n menness√§?",10:"Millainen on t√§ydellinen p√§iv√§si?",11:"Mit√§ haluaisit oppia t√§n√§ vuonna?",12:"Mik√§ asia sinussa on muuttunut viimeisen vuoden aikana?",13:"Milloin viimeksi teit jotain ensimm√§ist√§ kertaa?",14:"Mik√§ on t√§rkein arvosi?",15:"Kenelt√§ haluaisit pyyt√§√§ anteeksi?",16:"Mik√§ unelma tuntuu mahdottomalta?",17:"Millaisissa tilanteissa olet parhaimmillasi?",18:"Mit√§ sinulle merkitsee menestys?",19:"Mik√§ ominaisuutesi on vahvuutesi?",20:"Mist√§ luovut helposti ja mist√§ et?",21:"Millainen ymp√§rist√∂ saa sinut voimaan hyvin?",22:"Mik√§ musiikkikappale kuvaa t√§m√§nhetkist√§ el√§m√§√§si?",23:"Keneen olet viimeksi ihailevasti suhtautunut?",24:"Mik√§ tekee sinusta uniikin?",25:"Millaista yst√§vyytt√§ haluat vaalia?",26:"Mik√§ asia el√§m√§ss√§si kaipaa muutosta?",27:"Milloin olet viimeksi nauranut kunnolla?",28:"Mit√§ haluat sanoa itsellesi viiden vuoden p√§√§st√§?",29:"Mik√§ on suurin haaveesi?",30:"Mist√§ haluaisit p√§√§st√§√§ irti?",31:"Mik√§ sinussa on pysynyt samana lapsesta asti?",32:"Kenelle haluaisit soittaa juuri nyt?",33:"Mik√§ on t√§rkein opetuksesi rakkaudesta?",34:"Miten osoitat v√§litt√§mist√§si?",35:"Kenelt√§ kaipaat anteeksiantoa?",36:"Millainen yst√§v√§ olet?",37:"Mik√§ on suurin v√§√§rinymm√§rryksesi ihmissuhteissasi?",38:"Kenelle haluaisit sanoa 'rakastan sinua'?",39:"Mik√§ tekee suhteesta hyv√§n?",40:"Miten k√§sittelet konflikteja?",41:"Keneen luotat ehdoitta?",42:"Millaista tukea tarvitset muilta?",43:"Mik√§ on paras yhteinen muistosi jonkun kanssa?",44:"Miten haluat tulla muistetuksi?",45:"Kenelle olet t√§rkein?",46:"Mik√§ on viimeisin merkityksellinen keskustelusi?",47:"Miten voisit olla parempi kumppani?",48:"Mik√§ tekee ihmisest√§ kiinnostavan?",49:"Kenelt√§ olet oppinut eniten el√§m√§st√§?",50:"Millaista rakkautta annat itsellesi?",51:"Mik√§ on sinulle t√§rke√§√§ perheess√§?",52:"Miten haluat vaikuttaa muihin ihmisiin?",53:"Kenelle haluaisit kirjoittaa kirjeen?",54:"Mik√§ on suurin uhrauksesi jonkun puolesta?",55:"Miten hoidat yst√§vyyssuhteita?",56:"Mik√§ tekee sinusta hyv√§n kuuntelijan?",57:"Keneen haluaisit olla paremmin yhteydess√§?",58:"Millaista yhteytt√§ kaipaat?",59:"Mik√§ on paras komplimentti, jonka olet saanut?",60:"Mik√§ virheesi on opettanut sinulle eniten?",61:"Mit√§ haluaisit osata t√§ydellisesti?",62:"Mik√§ haastaa sinua positiivisesti?",63:"Millainen oppija olet?",64:"Mik√§ kirja on muuttanut ajatteluasi?",65:"Mist√§ aiheesta haluaisit tiet√§√§ enemm√§n?",66:"Mik√§ on ollut t√§rkein oppituntisi t√§n√§ vuonna?",67:"Miten kehit√§t itse√§si?",68:"Mik√§ taito olisi sinulle hy√∂dyllinen?",69:"Kenelt√§ haluaisit oppia?",70:"Mik√§ asia on sinulle viel√§ vaikeaa?",71:"Millainen haaste houkuttelee sinua?",72:"Mit√§ neuvoa antaisit nuoremmalle itsellesi?",73:"Mik√§ ep√§onnistumisesi on ollut siunaus?",74:"Miten suhtaudut virheisiin?",75:"Mik√§ motivoi sinua oppimaan?",76:"Millainen opettaja olet muille?",77:"Mik√§ taitosi on kehittynyt viime aikoina?",78:"Mit√§ haluat ymm√§rt√§√§ paremmin?",79:"Mik√§ on seuraava kehityshaasteesi?",80:"Miten k√§sittelet pettymyksi√§?",81:"Mik√§ kokemus on kypsytt√§nyt sinua?",82:"Millainen kasvu tuntuu oikealta?",83:"Mist√§ haluaisit olla rohkeampi?",84:"Mik√§ uusi n√§k√∂kulma on avannut silmi√§si?",85:"Miten otat vastaan palautetta?",86:"Mik√§ on paras oppisi vastoink√§ymisist√§?",87:"Millainen mentori tarvitsisit?",88:"Mik√§ kysymys askarruttaa sinua?",89:"Miten haluat kehitty√§ ihmisen√§?",90:"Mik√§ tietosi on osoittautunut v√§√§r√§ksi?",91:"Mik√§ tekee sinut luovaksi?",92:"Milloin olet viimeksi luonut jotain?",93:"Mik√§ into on j√§√§nyt toteuttamatta?",94:"Millainen taide koskettaa sinua?",95:"Mit√§ tekisit, jos ep√§onnistuminen olisi mahdotonta?",96:"Mik√§ harrastus tuo sinulle iloa?",97:"Millainen projekti innostaisi sinua?",98:"Mist√§ saat inspiraatiota?",99:"Mik√§ est√§√§ luovuuttasi?",100:"Millainen ymp√§rist√∂ her√§tt√§√§ mielikuvituksesi?",101:"Mik√§ taitosi on aliarvostettu?",102:"Mit√§ haluaisit luoda maailmaan?",103:"Mik√§ intohimosi on vahvin?",104:"Millainen leikki oli lapsena lempi√§si?",105:"Miten ilmaiset itse√§si?",106:"Mik√§ tekee sinusta energisen?",107:"Millainen luova prosessi sopii sinulle?",108:"Mist√§ unelmoit hiljaisina hetkin√§?",109:"Mik√§ projekti j√§i kesken?",110:"Millainen musiikki her√§tt√§√§ tunteesi?",111:"Mik√§ luova ty√∂ kiinnostaisi sinua?",112:"Miten voisit tuoda enemm√§n luovuutta arkeen?",113:"Mik√§ on erikoisin ideasi?",114:"Millainen taide haluaisit luoda?",115:"Mist√§ l√∂yd√§t flow-tilasi?",116:"Mik√§ intosi ansaitsisi enemm√§n aikaa?",117:"Millainen on luova tilasi?",118:"Mik√§ esto pit√§isi murtaa?",119:"Mist√§ saat voimaa luoda?",120:"Mik√§ tekisi sinusta onnellisemman luojan?",121:"Miten kehosi voi t√§n√§√§n?",122:"Mik√§ liikunta tuo sinulle iloa?",123:"Millainen ruoka ravitsee sinua parhaiten?",124:"Miten palaudut stressist√§?",125:"Mik√§ on t√§rkein huolehtimisesi tapa?",126:"Millainen uni tekee sinusta lev√§nneen?",127:"Mik√§ luontoel√§mys on j√§√§nyt mieleesi?",128:"Miten kuuntelet kehoasi?",129:"Mik√§ on paras tapasi rentoutua?",130:"Millainen liikunta haastaa sinua sopivasti?",131:"Mik√§ ruoka tuo sinulle lohtua?",132:"Miten hoidat terveytt√§si?",133:"Mik√§ on lempipaikkasi luonnossa?",134:"Millainen aamurituaali sopisi sinulle?",135:"Miten k√§sittelet kipua?",136:"Mik√§ tekee olosi virke√§ksi?",137:"Millainen lepo on sinulle t√§rke√§√§?",138:"Miten kehosi on muuttunut?",139:"Mik√§ tekee sinut vahvaksi?",140:"Millainen kosketus on sinulle t√§rke√§?",141:"Miten voisit liikkua enemm√§n ilosta?",142:"Mik√§ rutiini parantaa hyvinvointiasi?",143:"Millainen yhteys kehollasi ja mielell√§ on?",144:"Mik√§ tekee sinut energiseksi?",145:"Miten hoidat itse√§si sairaana?",146:"Mik√§ ulkoilma-aktiviteetti ilahduttaa sinua?",147:"Millainen ravinto tukee jaksamistasi?",148:"Miten kehosi viestii sinulle?",149:"Mik√§ on sinulle pyh√§ hetki p√§iv√§ss√§?",150:"Millainen kehosi on viisas?",151:"Miten haluat huolehtia itsest√§si paremmin?",152:"Mik√§ seikkailu kutsuisi sinua?",153:"Mihin haluaisit matkustaa?",154:"Mik√§ tekee sinusta vapaan?",155:"Millainen kes√§p√§iv√§ on t√§ydellinen?",156:"Mist√§ nautit kes√§ll√§ eniten?",157:"Mik√§ spontaani teko houkuttelisi?",158:"Millainen matka muuttaisi sinua?",159:"Mik√§ on parasta vapaudessa?",160:"Mihin haluaisit hyp√§t√§ p√§√§t√§ ensin?",161:"Millainen riski kannattaisi ottaa?",162:"Mik√§ paikka tuntuu kodilta?",163:"Mist√§ l√∂yd√§t rauhan?",164:"Millainen seikkailu pelottaa ja innostaa?",165:"Mik√§ vuodenaika kuvaa sinua parhaiten?",166:"Mihin haluaisit paeta juuri nyt?",167:"Mik√§ tekee hetkest√§ ikimuistoisen?",168:"Millainen matkakumppani olet?",169:"Mik√§ kulttuuriel√§mys on koskettanut sinua?",170:"Mihin suuntaan haluaisit ajelehtia?",171:"Mik√§ on paras spontaani muistosi?",172:"Millainen vapaus on sinulle t√§rke√§√§?",173:"Mik√§ este est√§√§ seikkailua?",174:"Mihin haluaisit kuluttaa kes√§si?",175:"Mik√§ tekee sinusta rohkean?",176:"Millainen paikka inspiroi sinua?",177:"Mik√§ matka olisi unelmiesi matka?",178:"Miten voisit tuoda enemm√§n seikkailua arkeen?",179:"Mik√§ on parasta kes√§ss√§?",180:"Millainen vapaus tekisi sinusta onnellisen?",181:"Mihin suuntaan el√§m√§si voisi suunnata?",182:"Mik√§ teki sinut iloiseksi t√§n√§√§n?",183:"Mist√§ olet syv√§sti kiitollinen?",184:"Mik√§ pieni asia tuo sinulle iloa?",185:"Kuka ihminen kirkastaa p√§iv√§si?",186:"Millainen hetki on t√§ynn√§ iloa?",187:"Mist√§ nautit aivan syd√§mest√§si?",188:"Mik√§ on paras lahjasi, jonka olet saanut?",189:"Millainen yll√§tys ilahduttaa sinua?",190:"Mist√§ haluaisit kiitt√§√§ el√§m√§√§?",191:"Mik√§ saa sinut hymyilem√§√§n?",192:"Millainen hetki on t√§ydellist√§ l√§sn√§oloa?",193:"Mist√§ arjen asiasta nautit?",194:"Mik√§ maku tai tuoksu tuo muistoja?",195:"Kenelle haluaisit sanoa kiitos?",196:"Mik√§ tekee sinusta ylpe√§n?",197:"Millainen onni on sinulle t√§rke√§√§?",198:"Mist√§ yll√§tyit positiivisesti?",199:"Mik√§ on paras muistosi viime vuodelta?",200:"Millainen hetki t√§ytt√§√§ syd√§mesi?",201:"Mist√§ haluaisit nauttia enemm√§n?",202:"Mik√§ tekee tavallisesta p√§iv√§st√§ hyv√§n?",203:"Kenelle olet tuonut iloa?",204:"Mik√§ on sinulle ylellisyytt√§?",205:"Millainen kiitollisuus l√§mmitt√§√§ sinua?",206:"Mist√§ haluat pit√§√§ kiinni?",207:"Mik√§ tapa viett√§√§ aikaa on arvokasta?",208:"Millainen ilo on puhdasta?",209:"Mist√§ tied√§t olevasi onnellinen?",210:"Mik√§ asia el√§m√§ss√§si on lahja?",211:"Millainen hetki ansaitset t√§n√§√§n?",212:"Mist√§ haluaisit kiitt√§√§ itse√§si?",213:"Mik√§ ty√∂ss√§si on merkityksellist√§?",214:"Millainen ty√∂ olisi unelmaty√∂t√§si?",215:"Mik√§ taitosi on arvokkain?",216:"Miten haluat vaikuttaa ty√∂si kautta?",217:"Mik√§ motivoi sinua ty√∂el√§m√§ss√§?",218:"Millainen kutsumus vet√§√§ sinua?",219:"Mik√§ ty√∂ss√§si on haastavaa?",220:"Miten haluat kehitty√§ ammatissasi?",221:"Mik√§ tekee ty√∂p√§iv√§st√§ hyv√§n?",222:"Millainen ty√∂ymp√§rist√∂ tukee sinua?",223:"Mik√§ projekti on ollut merkityksellisin?",224:"Miten tasapainotat ty√∂n ja muun el√§m√§n?",225:"Mik√§ on paras palautteesi ty√∂st√§?",226:"Millainen johtaja olet tai haluaisit olla?",227:"Mik√§ haaste ty√∂ss√§ kasvattaa sinua?",228:"Miten ilmaiset ammattitaitoasi?",229:"Mik√§ on unelmaty√∂si sis√§lt√∂?",230:"Millainen ty√∂yhteis√∂ sopii sinulle?",231:"Mik√§ on suurin saavutuksesi ty√∂ss√§?",232:"Miten k√§sittelet ty√∂stressi√§?",233:"Mik√§ tekee sinusta hyv√§n ty√∂kaverin?",234:"Millainen ty√∂ tuntuu merkitykselliselt√§?",235:"Mik√§ on t√§rkein oppisi ty√∂el√§m√§st√§?",236:"Miten haluat vaikuttaa maailmaan ty√∂si kautta?",237:"Mik√§ on seuraava ammatillinen tavoitteesi?",238:"Millainen balanssi ty√∂n ja vapaa-ajan v√§lill√§ on oikea?",239:"Mik√§ innostaa sinua ty√∂ss√§si?",240:"Miten haluat muistuttaa ty√∂si j√§lki√§?",241:"Mik√§ tekee ty√∂st√§ tyydytt√§v√§√§?",242:"Millainen ura olisi sinulle oikea?",243:"Mik√§ on t√§rkein arvosi ty√∂ss√§?",244:"Mist√§ olisi aika p√§√§st√§√§ irti?",245:"Mik√§ muutos pelottaa sinua?",246:"Millainen uusi alku houkuttelee?",247:"Mist√§ vanhasta tottumuksesta haluat luopua?",248:"Mik√§ muutos olisi sinulle hy√∂dyksi?",249:"Miten k√§sittelet menetyst√§?",250:"Mist√§ uskomuksesta voisit luopua?",251:"Mik√§ el√§m√§si kausi on p√§√§ttym√§ss√§?",252:"Millainen muutos tekisi sinusta vapaammaksi?",253:"Mist√§ suhteesta on aika jatkaa eteenp√§in?",254:"Mik√§ on vaikein asia p√§√§st√§√§ irti?",255:"Millainen uusi versio itsest√§si haluaa synty√§?",256:"Mist√§ taakasta haluat vapautua?",257:"Mik√§ muutos on v√§ist√§m√§t√∂n?",258:"Miten voisit helpottaa muutosta?",259:"Mist√§ menneisyydest√§ pid√§t edelleen kiinni?",260:"Mik√§ pelko est√§√§ muutosta?",261:"Millainen loppu on my√∂s alku?",262:"Mist√§ haluaisit anteeksi antaa itsellesi?",263:"Mik√§ tapa ajatella ei en√§√§ palvele sinua?",264:"Millainen muutos olisi rohkeaa?",265:"Mist√§ identiteetist√§si haluat luopua?",266:"Mik√§ suru kaipaa k√§sittely√§?",267:"Millainen siirtym√§vaihe olet nyt?",268:"Mist√§ on vaikea hyv√§stell√§?",269:"Mik√§ muutos tuntuu oikealta?",270:"Miten voisit tukea itse√§si muutoksessa?",271:"Mist√§ vanhentuneesta unelmasta voit luopua?",272:"Mik√§ uusi mahdollisuus avautuu p√§√§stett√§ess√§ irti?",273:"Millainen muutos vapauttaisi energiaasi?",274:"Milloin viimeksi olit todella hiljaa?",275:"Mik√§ ajatus nousee hiljaisuudessa?",276:"Millainen sis√§inen √§√§ni ohjaa sinua?",277:"Mik√§ syv√§ kysymys askarruttaa sinua?",278:"Miten l√∂yd√§t rauhan sis√§lt√§si?",279:"Mik√§ on t√§rkein totuutesi?",280:"Millainen hiljaisuus on arvokasta?",281:"Mist√§ syv√§st√§ asiasta haluaisit keskustella?",282:"Mik√§ on el√§m√§si suurin mysteeri?",283:"Miten kuuntelet itse√§si?",284:"Mik√§ tekee hetkest√§ pyh√§n?",285:"Millainen hiljaisuuden muoto on sinulle t√§rke√§?",286:"Mik√§ syv√§ pelko el√§√§ sis√§ll√§si?",287:"Miten l√∂yd√§t ytimesi?",288:"Mik√§ on suurin filosofinen kysymyksesi?",289:"Millainen kontemplatiivinen k√§yt√§nt√∂ sopisi sinulle?",290:"Mist√§ l√∂yd√§t merkityksen?",291:"Mik√§ on el√§m√§si syvempi tarkoitus?",292:"Miten yksinolo vaikuttaa sinuun?",293:"Mik√§ on t√§rkein sis√§inen viisautesi?",294:"Millainen hiljaisuus pelottaa sinua?",295:"Mist√§ arvoistasi et tingi?",296:"Mik√§ on syvimm√§n olemuksesi luonne?",297:"Miten meditaatio tai rauhoittuminen tukee sinua?",298:"Mik√§ kysymys johtaa aina syvemm√§lle?",299:"Millainen hiljaisuus parantaa?",300:"Mist√§ l√∂yd√§t henkisen kotisi?",301:"Mik√§ on syv√§llisint√§ kommunikaatiota?",302:"Miten luot tilaa sis√§iselle √§√§nellesi?",303:"Mik√§ totuus on vaikea kohdata?",304:"Millainen syvyys rikastuttaa el√§m√§√§si?",305:"Mik√§ on pimeydess√§si valoa?",306:"Miten k√§sittelet synkki√§ aikoja?",307:"Mik√§ tuo sinulle toivoa?",308:"Millainen pimeys on osa sinua?",309:"Mist√§ l√∂yd√§t valon pimeimpin√§ hetkin√§?",310:"Mik√§ puolesi kaipaa hyv√§ksynt√§√§?",311:"Miten hoidat masentuneisuutta?",312:"Mik√§ tekee sinusta resilientin?",313:"Millainen varjo sinulla on?",314:"Mist√§ ammennat voimaa vaikeina aikoina?",315:"Mik√§ on suurin pelkosi?",316:"Miten k√§sittelet ahdistusta?",317:"Mik√§ tuo sinulle lohtua?",318:"Millainen pimeys on luovaa?",319:"Mist√§ l√∂yd√§t rohkeutta?",320:"Mik√§ on sinulle turvasatama?",321:"Miten kohtaat kipusi?",322:"Mik√§ tekee sinusta rohkean?",323:"Millainen haavoittuvuus on voimaa?",324:"Mist√§ tied√§t selvi√§v√§si?",325:"Mik√§ on opettanut sinua k√§rsimys?",326:"Miten autat itse√§si pime√§n√§ aikana?",327:"Mik√§ on toivon l√§hteesi?",328:"Millainen pimeys on hyv√§ksytt√§v√§√§?",329:"Mist√§ l√∂yd√§t sis√§isen valosi?",330:"Mik√§ tekee sinusta sitke√§n?",331:"Miten muistutat itse√§si omasta arvostasi?",332:"Mik√§ on suurin haasteesi t√§ll√§ hetkell√§?",333:"Millainen tuki auttaa sinua?",334:"Mist√§ tied√§t, ett√§ huominen on parempi?",335:"Mist√§ olet kiitollinen t√§lt√§ vuodelta?",336:"Mik√§ on suurin oppisi t√§n√§ vuonna?",337:"Millainen olet kasvanut?",338:"Mik√§ hetki on ollut merkityksellisin?",339:"Kenelle haluat kiitt√§√§ t√§st√§ vuodesta?",340:"Mik√§ muutos on tapahtunut sinussa?",341:"Mist√§ olet ylpe√§ t√§lt√§ vuodelta?",342:"Millainen haave toteutui?",343:"Mik√§ yll√§tys ilahdutti sinua t√§n√§ vuonna?",344:"Miten olet muuttunut?",345:"Mik√§ unelma j√§i toteutumatta?",346:"Millaista hyv√§√§ tapahtui?",347:"Mist√§ virheest√§ opit t√§n√§ vuonna?",348:"Mik√§ suhde syveni?",349:"Millainen tavoite saavutettiin?",350:"Mist√§ on vaikea hyv√§stell√§ t√§m√§ vuosi?",351:"Mik√§ tekee sinusta kiitollisen juuri nyt?",352:"Millainen haluaisit olla ensi vuonna?",353:"Mik√§ unelma odottaa toteutumista?",354:"Miten haluat kasvaa ensi vuonna?",355:"Mik√§ on t√§rke√§ tavoitteesi?",356:"Millaista rakkautta haluat kokea?",357:"Mist√§ haluat oppia enemm√§n?",358:"Mik√§ seikkailu odottaa sinua?",359:"Millainen muutos on edess√§?",360:"Mit√§ lupaat itsellesi ensi vuodelle?",361:"Mik√§ t√§st√§ vuodesta ansaitsee tulla muistelluksi viel√§ vuosien p√§√§st√§?",362:"Mist√§ olet kiitollinen itsess√§si juuri nyt?",363:"Mit√§ haluat j√§tt√§√§ t√§h√§n vuoteen lopullisesti?",364:"Mit√§ toivot salaa ensi vuodelta?",365:"Mill√§ sanoilla kuvailisit kulunutta vuotta itsellesi?"
    };
    return questions[dayOfYear] || "Mit√§ ajattelet t√§n√§√§n?";
}

// --- Autentikointi ---
document.getElementById("registerBtn").addEventListener("click", async () => {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    try {
        await createUserWithEmailAndPassword(auth, email, password);
        alert("Rekister√∂ityminen onnistui!");
    } catch(e) { alert(e.message); }
});

document.getElementById("loginBtn").addEventListener("click", async () => {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    try {
        await signInWithEmailAndPassword(auth, email, password);
    } catch(e) { alert(e.message); }
});

window.logout = function() { signOut(auth); }

onAuthStateChanged(auth, (user) => {
    if(user) {
        document.getElementById("loginContainer").style.display = "none";
        document.getElementById("diaryContainer").style.display = "block";
        generateWeek(currentWeek, user.uid);
    } else {
        document.getElementById("loginContainer").style.display = "block";
        document.getElementById("diaryContainer").style.display = "none";
    }
});

// --- P√§iv√§m√§√§r√§- ja viikkofunktiot ---
function getDateOfISOWeek(week, year) {
    const simple = new Date(year, 0, 1 + (week - 1) * 7);
    const dow = simple.getDay();
    const ISOweekStart = simple;
    if (dow <= 4)
        ISOweekStart.setDate(simple.getDate() - simple.getDay() + 1);
    else
        ISOweekStart.setDate(simple.getDate() + 8 - simple.getDay());
    return ISOweekStart;
}

function getDayOfYear(date) {
    const start = new Date(date.getFullYear(), 0, 0);
    const diff = date - start;
    const oneDay = 1000 * 60 * 60 * 24;
    return Math.floor(diff / oneDay);
}

// --- Viikon generointi ---
async function generateWeek(weekNumber, uid) {
    const container = document.getElementById("weekContainer");
    const weekNumberDiv = document.getElementById("weekNumber");

    const weekStart = getDateOfISOWeek(weekNumber, year);

    weekNumberDiv.innerText = "Viikko " + weekNumber;

    container.innerHTML = "";

    // Debounce funktio tallennukselle
    let saveTimers = {};
    
    for(let i=0; i<7; i++) {
        const date = new Date(weekStart);
        date.setDate(weekStart.getDate() + i);

        const dayOfYear = getDayOfYear(date);
        const question = getQuestion(dayOfYear);
        const key = year + "-" + date.toISOString().split("T")[0];

        // Hae tallennettu vastaus Firestoresta
        const docRef = doc(db, "diaries", uid + "_" + key);
        let savedText = "";
        try {
            const docSnap = await getDoc(docRef);
            if(docSnap.exists()) savedText = docSnap.data().answer || "";
        } catch(e){ console.log(e); }

        const card = document.createElement("div");
        card.className = "day-card";
        card.innerHTML = `
            <div class="day-title">${days[i]}</div>
            <div class="question">${question}</div>
            <textarea rows="4" placeholder="Kirjoita ajatuksesi t√§h√§n...">${savedText}</textarea>
        `;
        
        const textarea = card.querySelector("textarea");
        
        // Debounced save - odottaa 1 sekuntin ennen tallennusta
        textarea.addEventListener("input", () => {
            clearTimeout(saveTimers[key]);
            saveTimers[key] = setTimeout(async () => {
                try {
                    await setDoc(doc(db, "diaries", uid + "_" + key), { answer: textarea.value });
                } catch(e){ console.log(e); }
            }, 1000);
        });

        container.appendChild(card);
    }
}

window.nextWeek = function(){ 
    if(currentWeek<53){ 
        currentWeek++; 
        generateWeek(currentWeek, auth.currentUser.uid); 
    }
}

window.prevWeek = function(){ 
    if(currentWeek>1){ 
        currentWeek--; 
        generateWeek(currentWeek, auth.currentUser.uid); 
    }
}

</script>
</body>
</html>
